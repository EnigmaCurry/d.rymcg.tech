version: "3.3"

#networks:
#  traefik-proxy:
#    external:
#      name: traefik-proxy

services:
  restic:
    networks:
    ## Connect to the Traefik proxy network (allows to be exposed):
#    - traefik-proxy
    ## If there are additional containers for the backend,
    ## also connect to the default (not exposed) network:
      - default
    image: "restic-backup"
    container_name: "restic"
    restart: on-failure
    # docker run -i
    stdin_open: true
    # docker run -t
    environmnet:
      - RESTIC_PASSWORD
      - RESTIC_TAG
      - BACKUP_CRON
      - RESTIC_FORGET_ARGS
      - DIR_TO_BACKUP
      - BACKUP_REPO
    tty: true
    volumes:
      - ${DIR_TO_BACKUP}:/data
      - ${BACKUP_REPO}/:/mnt/restic
      - ${RESTORE_DIR}:/restore
