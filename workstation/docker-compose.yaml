version: "3.9"

volumes:
  workstation-home:

services:
  workstation:
    build:
      context: src
      args:
        WORKSTATION_UID: ${WORKSTATION_UID}
        WORKSTATION_GID: ${WORKSTATION_GID}
        WORKSTATION_USER: ${WORKSTATION_USER}
    security_opt:
      - no-new-privileges:true
    sysctls:
      - net.ipv4.ip_unprivileged_port_start=1024
    user: ${WORKSTATION_UID}:${WORKSTATION_GID}
    volumes:
      - workstation-home:/home
    ports:
      - ${WORKSTATION_PUBLIC_SSH_PORT}:2222
    restart: unless-stopped
    container_name: workstation-${INSTANCE:-default}
    hostname: workstation-${INSTANCE:-default}
    labels: []
