version: "3.9"

volumes:
  workstation-home:

services:
  workstation:
    build:
      context: src
    sysctls:
      - net.ipv4.ip_unprivileged_port_start=1024
    volumes:
      - workstation-home:/home
      - /var/run/docker.sock:/var/run/docker.sock:ro
    ports:
      - ${WORKSTATION_PUBLIC_SSH_PORT}:2222
    restart: unless-stopped
    container_name: workstation-${WORKSTATION_DOCKER_CONTEXT}-${INSTANCE:-default}
    hostname: workstation-${WORKSTATION_DOCKER_CONTEXT}-${INSTANCE:-default}
    environment:
      - WORKSTATION_UID
      - WORKSTATION_GID
      - WORKSTATION_USER
      - WORKSTATION_DOCKER_CONTEXT
    labels: []
