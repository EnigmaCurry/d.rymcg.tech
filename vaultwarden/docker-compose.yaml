version: "3.9"

services:
  vaultwarden:
    image: vaultwarden/server:${VAULTWARDEN_VERSION}
    security_opt:
      - no-new-privileges:true
    cap_drop:
      - ALL
    cap_add:
      - CHOWN
      - DAC_OVERRIDE
      - SETGID
      - SETUID
      - FOWNER
      - NET_BIND_SERVICE
    restart: always
    environment:
      - WEBSOCKET_ENABLED=true
      - SIGNUPS_ALLOWED=${VAULTWARDEN_SIGNUPS_ALLOWED}
      - SHOW_PASSWORD_HINT=${VAULTWARDEN_SHOW_PASSWORD_HINT}
      - INVITATIONS_ALLOWED=${VAULTWARDEN_INVITATIONS_ALLOWED}
      - DOMAIN=https://${VAULTWARDEN_TRAEFIK_HOST}/
    volumes:
      - data:/data
    # labels are defined in docker-compose.instance.yaml
    labels: []

volumes:
  data:
