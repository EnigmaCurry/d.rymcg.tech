#!/bin/bash

# helper to base64url‚Äêencode
b64u() { openssl base64 -e -A | tr '+/' '-_' | tr -d '='; }

SECRET="YOUR_SECRET"
NOW=$(date +%s)
EXP=$((NOW + 3600))  # 1 hour

# header + payload
H='{"alg":"HS256","typ":"JWT"}'
P=$(printf '{"iat":%d,"exp":%d}' "$NOW" "$EXP")

# assemble unsigned token
U=$(printf '%s' "$H" | b64u).$(printf '%s' "$P" | b64u)

# signature
S=$(printf '%s' "$U" \
    | openssl dgst -sha256 -hmac "$SECRET" -binary \
    | b64u)

echo "${U}.${S}"
