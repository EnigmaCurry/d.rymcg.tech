version: '3'

volumes:
  database:

services:
  thttpd:
    build:
      context: .
    restart: unless-stopped
    security_opt:
      - no-new-privileges:true
    environment:
      - THTTPD_CACHE_CONTROL
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.thttpd.rule=Host(`${THTTPD_TRAEFIK_HOST}`)"
      - "traefik.http.routers.thttpd.entrypoints=websecure"
      - "traefik.http.routers.thttpd.tls.certresolver=${ACME_CERT_RESOLVER:-production}"
      ## Authentication:
      #- "traefik.http.middlewares.thttpd-auth.basicauth.users=${THTTPD_HTTP_AUTH}"
      #- "traefik.http.routers.thttpd.middlewares=thttpd-auth@docker"
