version: "3.9"

volumes:
  user-home:

services:
  nix-user:
    container_name: nix-${INSTANCE:-default}
    hostname: nix-${INSTANCE:-default}
    build:
      context: nix-terminal
    security_opt:
      - no-new-privileges:true
    cap_drop:
      - ALL
    sysctls:
      - net.ipv4.ip_unprivileged_port_start=1024
    #user: ${NIX_USER_UID}:${NIX_USER_GID}
    restart: unless-stopped
    volumes:
      - user-home:/home/${NIX_USER_NAME}
